(ns akvo.lumen.specs.import.values
  (:require [clojure.spec.alpha :as s]
            [akvo.lumen.util :refer (squuid)]
            [akvo.lumen.specs :as lumen.s :refer (sample)]
            [akvo.lumen.lib.import.csv :as csv]))

(def point "POINT(10 10)")
(def polygon
  "POLYGON ((-8.5613392399999 6.26400125800006,-8.58240600799991 6.28328019,-8.58407264599992 6.28495050300006,-8.59442501299992 6.29532535,-8.59942744899996 6.30033843500007,-8.60370201399991 6.30558555600004,-8.62070288399991 6.32645549500006,-8.63825875099991 6.34511131500005,-8.65760929199996 6.36162501,-8.65868241299995 6.36254106600006,-8.65688395499996 6.36546966,-8.65373952399995 6.37234820100008,-8.65373480799991 6.37937809500005,-8.65468317899996 6.39192557300004,-8.65614451599993 6.40059999500005,-8.65547095599993 6.40043162700005,-8.65459112299993 6.40109083,-8.65216987399992 6.40290462,-8.64473960799995 6.41280152400009,-8.64473638599992 6.41582175800005,-8.64473163299994 6.42023451100005,-8.63729795899991 6.43755125400008,-8.62942384299993 6.44420684,-8.6287193499999 6.44532068,-8.62719829799994 6.44851845600004,-8.6279669099999 6.45249924800004,-8.62807416399994 6.45501184700004,-8.62811361699994 6.45593965400008,-8.62616719199991 6.45952778500009,-8.6219798 6.46057176500005,-8.62142156499993 6.46105248200007,-8.61800030499995 6.46399778,-8.61762950399992 6.46401163600007,-8.61583033099993 6.46407812600006,-8.61571237299995 6.46908610700007,-8.61565923099994 6.47134303400009,-8.62024340599993 6.48632546300007,-8.62147762799992 6.49050279200009,-8.61674562499991 6.49603140100004,-8.61576401299993 6.49644394400008,-8.61140786399994 6.49967567600004,-8.61030586699991 6.50005193100009,-8.6100366499999 6.49951179400006,-8.60889232299991 6.50053423300005,-8.60672733399991 6.50127319200004,-8.60572371299992 6.50161559100007,-8.59002009199992 6.50354741600006,-8.56601802899991 6.50435000100009,-8.55689863199996 6.50165037700009,-8.55218646899993 6.49857062900008,-8.55002389899994 6.49715698900008,-8.54255176699991 6.49146666,-8.53224080699994 6.48368007,-8.52558850299994 6.48180422800004,-8.51721545099991 6.48074927400006,-8.51123336699993 6.48149152600007,-8.50884128499996 6.48089106,-8.50376205699996 6.47624900400007,-8.50122506699995 6.47071273600005,-8.49838984 6.46502634400008,-8.49286074099996 6.46173044700009,-8.48583405199992 6.46052708900004,-8.48438198099996 6.46056010800004,-8.47955380399992 6.46066996300004,-8.47633940499992 6.46014314100006,-8.4737996499999 6.45819624300009,-8.4702103499999 6.45894049500009,-8.4658710699999 6.46177803200004,-8.46167953799994 6.46596124200005,-8.45883413699994 6.47029566700007,-8.45822592599995 6.47986713100005,-8.45971603399994 6.48450523700006,-8.45732177899993 6.48599805800006,-8.4513396019999 6.48673959100006,-8.44550818199991 6.48658399300007,-8.44311683599994 6.48538450800004,-8.44147413399992 6.48343843400005,-8.44073028099996 6.47984815500007,-8.43953738599993 6.47700534800009,-8.43580544199995 6.47116785100008,-8.43027824799992 6.46652518800005,-8.42280790799992 6.46143137900009,-8.41376745299993 6.45596196700006,-8.40943468599994 6.45296566400009,-8.40106815899992 6.44757202400007,-8.39912710499993 6.44532584700005,-8.40152266799993 6.44218811300004,-8.40526324699994 6.44009840700005,-8.40885679099995 6.43561591300005,-8.41095280099995 6.43337499900008,-8.41245027199994 6.43113282200005,-8.41334965599992 6.42948866600005,-8.41305342299995 6.42709517100008,-8.41214708399991 6.42692452400007,-8.41066157299991 6.42664409400004,-8.40886577799995 6.42783831700007,-8.40736691699993 6.43127677500007,-8.40676618699996 6.43366923100007,-8.40542015299991 6.43396674,-8.40407655699994 6.43217017100005,-8.40303770199995 6.42543839800004,-8.40252159399995 6.41923131900006,-8.3990875 6.41503914700007,-8.39520511899991 6.41099624800006,-8.39550866199994 6.40710809100005,-8.39603682299992 6.40299575100005,-8.3966384299999 6.39985590700007,-8.39380227399994 6.39626256100007,-8.38962178799994 6.39117281,-8.38693708599993 6.38623406800008,-8.38753978399996 6.38219645400005,-8.39187978399991 6.37846233200008,-8.39890690699991 6.37757335300006,-8.40144896699991 6.37742649100005,-8.40608777799991 6.37369258200005,-8.41042587299995 6.37145421900004,-8.41401341299991 6.37175738,-8.41506135099991 6.37056227,-8.41551168199993 6.36861851300006,-8.41282200499995 6.36741859800009,-8.40773773899991 6.36890872800006,-8.40348210499991 6.36434196100009,-8.40223154599994 6.36091049400005,-8.40215695099994 6.36042306900009,-8.41679366099993 6.33319118400004,-8.4327949199999 6.30604331400008,-8.44133567899991 6.28421371600007,-8.44401159799992 6.27090000600009,-8.44776185099994 6.24799995200004,-8.45301201599995 6.24165356600008,-8.45635800299993 6.23760845200007,-8.45771165599996 6.23597254900005,-8.46055947499991 6.22564115300008,-8.47307428799991 6.21952860800008,-8.48985671199995 6.20784703400005,-8.49065098399996 6.20729430300008,-8.5035458799999 6.19689187,-8.50848730499996 6.20118593800004,-8.51912126599996 6.21344672100008,-8.52869512199993 6.22144517,-8.53826824099991 6.22997661100004,-8.54678147799996 6.23424520800006,-8.55369361099991 6.24330612100005,-8.54836486199991 6.24969368,-8.54570227699992 6.25075711400007,-8.55793713099996 6.26088772100007,-8.5613392399999 6.26400125800006))")

(def multipolygon
  "MULTIPOLYGON (((-11.2515839389999 6.82938166900004,-11.251466353 6.82829017,-11.2476186849999 6.82396083100008,-11.2480445479999 6.80876617200005,-11.2483346839999 6.79842056,-11.2483646199999 6.79735266200004,-11.2464470129999 6.79649210400004,-11.2422799239999 6.79825035100009,-11.237410607 6.79862033400008,-11.2337286019999 6.79237761600007,-11.2307406959999 6.78578306600008,-11.2298041429999 6.78233604,-11.2317194629999 6.78219390200007,-11.2330217689999 6.78243536100007,-11.2347495679999 6.78094100200008,-11.2371640889999 6.78055813400005,-11.2409488 6.78171747,-11.2434913769999 6.78220118300004,-11.2451618339999 6.78169799100004,-11.2465145429999 6.77946242600007,-11.248057054 6.77809261800007,-11.2495465769999 6.77864332500008,-11.250789713 6.77950419600006,-11.2515982309999 6.78018177600006,-11.2515431079999 6.78166841800004,-11.2511161009999 6.78309464,-11.2516768009999 6.78377336800008,-11.2534741809999 6.78388930900007,-11.2554554839999 6.78363208600007,-11.2576266139999 6.78417958900008,-11.2598004929999 6.78534625,-11.2612874399999 6.78533931800007,-11.2636975759999 6.78402700100008,-11.2643142409999 6.78340494200006,-11.2655507509999 6.78284213100005,-11.2660364089999 6.78073374700006,-11.2672055219999 6.77899446900005,-11.2686883849999 6.77812035,-11.2699290799999 6.77848628300006,-11.2717284519999 6.77903546300007,-11.2728413159999 6.77853479800007,-11.2738301269999 6.77803471200008,-11.274640255 6.77902182500009,-11.2761925379999 6.77975744500009,-11.277743954 6.78030776200006,-11.2804000699999 6.77862306500009,-11.2822109269999 6.77801006800007,-11.2830519349999 6.77600961900009,-11.2840922539999 6.77327946300005,-11.2846483079999 6.77296726200007,-11.285332782 6.77358321400004,-11.2855244069999 6.77482122100008,-11.28584008 6.77605807900005,-11.2870206359999 6.77679597700006,-11.288012481 6.77691502500005,-11.2888113819999 6.77554863200004,-11.2901653019999 6.77362259500006,-11.2909354459999 6.77272128,-11.2937847019999 6.77258354800006,-11.294760224 6.77245013600009,-11.2970660889999 6.77213473900008,-11.2995421479999 6.77168972100009,-11.3027614839999 6.77124060600005,-11.3047401409999 6.77042619800005,-11.3093820669999 6.76947541600009,-11.3123511929999 6.76853199200008,-11.313098834 6.76787198900007,-11.313338293 6.76766069600006,-11.3158054309999 6.76535760800004,-11.3182170199999 6.76441681500006,-11.3205643539999 6.76298144500009,-11.3224723279999 6.76037143,-11.324106131 6.75872252800008,-11.3258987579999 6.75790895100005,-11.3275094509999 6.75790125200007,-11.3296204849999 6.75888202600004,-11.3320432799999 6.76029458700009,-11.3342766 6.76096517200006,-11.3354572839999 6.76170237500008,-11.3362045499999 6.76250379600009,-11.3375597069999 6.76088727,-11.3395282499999 6.75802949700005,-11.3435500969999 6.75701928900008,-11.3449001729999 6.75585103100008,-11.3456895059999 6.75641910200005,-11.3479313039999 6.75773701600008,-11.3498733659999 6.75953953400006,-11.3513872709999 6.76025697600005,-11.3535106029999 6.76205859400005,-11.355387016 6.76277426600006,-11.3570801339999 6.76306804400008,-11.3589483459999 6.76209265400007,-11.3619063789999 6.76159513600004,-11.3624445459999 6.76044500400008,-11.363042833 6.75923418500008,-11.3646731679999 6.75904508,-11.3657650509999 6.75994570700004,-11.3665533909999 6.76054583,-11.3671631319999 6.76169037900007,-11.3666285059999 6.76356524200008,-11.3656718489999 6.76562334600004,-11.365798857 6.76689103500007,-11.3668327009999 6.7682751,-11.3695954219999 6.77017305500004,-11.3694816629999 6.77051985100007,-11.3712380339999 6.77398826900009,-11.3714894359999 6.77469543200004,-11.3680244149999 6.77487333900007,-11.3640280989999 6.77576220300006,-11.361263688 6.77960121300009,-11.3612848629999 6.78394807800004,-11.359564894 6.78795543900009,-11.3513870629999 6.78747376800004,-11.3451174059999 6.78593933,-11.3397310749999 6.78718218400007,-11.3364537129999 6.79293586200009,-11.3359779369999 6.79356804100007,-11.3331697199999 6.79729874500009,-11.3257065379999 6.80081232100008,-11.3223971819999 6.79995880200005,-11.3199091249999 6.79986283800008,-11.318395457 6.79980399700008,-11.3161441159999 6.80190161400009,-11.3161732959999 6.80798741600006,-11.3167251329999 6.81424414100007,-11.3228330199999 6.81821444900004,-11.3216252509999 6.82030652200007,-11.3181687249999 6.82501822900008,-11.3138446699999 6.83025552800007,-11.3091584509999 6.83253828900007,-11.305338693 6.83412144300007,-11.3004146189999 6.83384671100009,-11.2995961079999 6.83380147200006,-11.2931517899999 6.83226677400006,-11.2898497739999 6.83297848500007,-11.2860406429999 6.83682176800005,-11.2841525859999 6.84222136300008,-11.282228604 6.84351629600008,-11.2779092879999 6.84642418300007,-11.272011442 6.85010388200004,-11.2704645249999 6.85411042100009,-11.2680404149999 6.85655621900008,-11.266895652 6.85656162700008,-11.2659526819999 6.85656608,-11.2577419769999 6.84947514400005,-11.253629508 6.84526807200007,-11.2524973899999 6.84410958300009,-11.2524761939999 6.83958839300004,-11.2521029029999 6.83419939300006,-11.2515839389999 6.82938166900004)),((-11.374076391 6.76067149500005,-11.3711955839999 6.76529516300008,-11.3705253019999 6.76733830200004,-11.369149627 6.76640105200005,-11.3688942819999 6.76485389,-11.3693187949999 6.76299384900005,-11.3701743 6.76057471200005,-11.3699186619999 6.75896597800005,-11.3692641229999 6.75786195,-11.3688568719999 6.75717531200007,-11.3677333729999 6.75544651600006,-11.3671129959999 6.75526424300006,-11.3647013189999 6.75614252700007,-11.3640812399999 6.75602182400007,-11.3598527119999 6.75910753200009,-11.3573803199999 6.76023464600007,-11.3554596799999 6.76018180700004,-11.3536591979999 6.75938551900009,-11.3520407459999 6.75778334400007,-11.3504221449999 6.75611901900004,-11.348126534 6.75538666900007,-11.3471820429999 6.75493590100007,-11.3463199559999 6.75323288300007,-11.3456475789999 6.75190461700009,-11.3444915389999 6.75108766500006,-11.3417621959999 6.74876034,-11.3414796629999 6.74867583,-11.3405286429999 6.74839172500009,-11.3382946139999 6.74585240700009,-11.3367212979999 6.74380308,-11.3370417869999 6.74199211100006,-11.3375248819999 6.73976853800008,-11.3377584199999 6.73697050900006,-11.3375039949999 6.73540859800005,-11.3366744109999 6.73401439400004,-11.3369929359999 6.73179161,-11.3371476709999 6.72973400100005,-11.3357413719999 6.72817815600007,-11.3337642419999 6.72769385800007,-11.3316263199999 6.72803284200006,-11.3280163599999 6.73027131900005,-11.3241363289999 6.72765723900005,-11.3204218339999 6.72520728800009,-11.317691958 6.72217640800005,-11.3125715649999 6.71825178300008,-11.3089355209999 6.71497822600008,-11.3067045309999 6.71301430300008,-11.3020853719999 6.71065031600006,-11.3000286529999 6.71074245100004,-11.2982204049999 6.71116220500005,-11.2960747639999 6.70985596200006,-11.2949730899999 6.70869678900004,-11.293428623 6.70707135,-11.2909550159999 6.70601348600007,-11.2882432119999 6.70676621300004,-11.2862729249999 6.70776291500005,-11.281411659 6.70638676200008,-11.27802571 6.70377043400009,-11.2752139639999 6.70073956600004,-11.2717040429999 6.69799945600005,-11.2685674049999 6.69587507100005,-11.2663389059999 6.69440463200004,-11.2632011699999 6.69203331900007,-11.2606416639999 6.69015308300004,-11.2585792909999 6.68901062900005,-11.2548708319999 6.68779379500006,-11.251991787 6.68797138700006,-11.2478704709999 6.68642701400006,-11.2446595039999 6.68603038800006,-11.2404536049999 6.68399311800005,-11.2370744699999 6.68277405800006,-11.2350147729999 6.68220772200004,-11.2333296219999 6.68258541900008,-11.2283884829999 6.68170331100009,-11.2236171199999 6.68197121100008,-11.2190956379999 6.68289668800008,-11.2149799379999 6.68258641700004,-11.2135789029999 6.68209893900007,-11.2117600779999 6.68021503800009,-11.2096985379999 6.67923672900008,-11.2068174529999 6.67900275700009,-11.2031899629999 6.67745628900008,-11.2007089909999 6.67467020400005,-11.200209023 6.67327356500004,-11.1989814049999 6.67475983700007,-11.1987425539999 6.67657107500008,-11.1970117189999 6.67922739100004,-11.1966993899999 6.67970618700008,-11.1949875639999 6.68333417300005,-11.1948266569999 6.68415749300004,-11.1960719349999 6.68661974100007,-11.1945158589999 6.68827245500006,-11.1913210869999 6.69149519400008,-11.188946841 6.69422104600005,-11.185502852 6.69695109200006,-11.1838672719999 6.69926178100008,-11.1825623129999 6.70190038100009,-11.182004639 6.70601646700004,-11.1819310639999 6.70799139400009,-11.1826860649999 6.71119654300009,-11.1824861979999 6.71279180100004,-11.179016804 6.71489427300008,-11.1758959759999 6.71716863100005,-11.1744609749999 6.71414727200005,-11.1718574359999 6.70866550200009,-11.1650377669999 6.70052259500005,-11.1582682839999 6.69680145400008,-11.1571915469999 6.69620955700009,-11.1509070949999 6.69101999800006,-11.1498359839999 6.68476402500005,-11.1496166719999 6.68307057700008,-11.1487561039999 6.67642156700009,-11.1479569489999 6.66680042400009,-11.1474709459999 6.66094979100006,-11.1486470589999 6.65138050100006,-11.1534546199999 6.63709924300008,-11.1574024299999 6.62508284100005,-11.1593573139999 6.61953406800006,-11.1597267769999 6.61968218300007,-11.1715708219999 6.62380408900009,-11.183429385 6.63122958200006,-11.1897141519999 6.63352844800005,-11.1989328139999 6.63689952100009,-11.213048075 6.64327110400006,-11.2404915709999 6.65479822,-11.2478979959999 6.65718711400007,-11.250593346 6.65805617,-11.2667965269999 6.66441626700009,-11.2826586449999 6.67216815300009,-11.2960797939999 6.67853931,-11.3072067439999 6.68329261400004,-11.3194315269999 6.68851495300004,-11.3331978 6.69418773200005,-11.343478617 6.69831184500009,-11.3575898259999 6.70328725900009,-11.3643959079999 6.70812289100007,-11.368946305 6.71401267300007,-11.3691370249999 6.71748931400009,-11.3714198099999 6.7219992,-11.3745681749999 6.72563490700009,-11.3765819 6.72685209500008,-11.3777079889999 6.72753241300006,-11.3812995849999 6.73290522,-11.3850521689999 6.73810319700004,-11.3856774179999 6.73896895700005,-11.3860515869999 6.74435739400008,-11.383992588 6.75010514800005,-11.381402352 6.75394332,-11.3766455769999 6.75730682200009,-11.3762023759999 6.75762024700009,-11.374076391 6.76067149500005)))")

;;{:title "Fluoride", :type :multiple, :id :c116809115, :multiple-type :caddisfly, :multiple-id "f0f3c1dd-89af-49f1-83e7-bcc31c3006cf"}
(def cad1-id "f0f3c1dd-89af-49f1-83e7-bcc31c3006cf")
(def cad1
  "{\"device\":{\"model\":\"ASUS_Z00LD\",\"product\":\"WW_Z00L\",\"manufacturer\":\"asus\",\"os\":\"Android - 6.0.1 (23)\",\"country\":\"US\",\"language\":\"en\"},\"image\":\"b1961e99-bc1c-477c-9309-ae5e8d2374e8.png\",\"user\":{\"backDropDetection\":false,\"language\":\"en\"},\"name\":\"Water - Fluoride\",\"uuid\":\"f0f3c1dd-89af-49f1-83e7-bcc31c3006cf\",\"testDate\":\"2017-02-06 00:50\",\"type\":\"caddisfly\",\"app\":{\"appVersion\":\"Version 1.0.0 Beta 9.0\",\"language\":\"en\"},\"result\":[{\"name\":\"Fluoride\",\"unit\":\"ppm\",\"id\":1,\"value\":\"1.51\"}]}")

;;{:title "Soil - Nitrogen", :type :multiple, :id :c117759118, :multiple-type :caddisfly, :multiple-id "53a1649a-be67-4a13-8cba-1b7db640037c"}
(def cad2
  "{\"device\":{\"model\":\"ASUS_Z00LD\",\"product\":\"WW_Z00L\",\"manufacturer\":\"asus\",\"os\":\"Android - 6.0.1 (23)\",\"country\":\"ID\",\"language\":\"in\"},\"image\":\"27a1821b-7bfa-4254-81b2-10a5446fa5f9.png\",\"user\":{\"backDropDetection\":true,\"language\":\"in\"},\"name\":\"Soil - Available Nitrogen\",\"uuid\":\"53a1649a-be67-4a13-8cba-1b7db640037c\",\"testDate\":\"2017-02-14 14:27\",\"type\":\"caddisfly\",\"app\":{\"appVersion\":\"Version 1.0.0 Alpha 8.6 (Build 167)\",\"language\":\"en\"},\"result\":[{\"name\":\"Available Nitrogen\",\"unit\":\"kg/ha\",\"id\":1,\"value\":\"582.4\"},{\"name\":\"Nitrate Nitrogen\",\"unit\":\"ppm\",\"id\":2,\"value\":\"50.0\"},{\"name\":\"Nitrite Nitrogen\",\"unit\":\"ppm\",\"id\":3,\"value\":\"2.0\"}]}")

;; locate uuid and title
(def cad3
  "{\"device\":{\"model\":\"ASUS_Z00LD\",\"product\":\"WW_Z00L\",\"manufacturer\":\"asus\",\"os\":\"Android - 6.0.1 (23)\",\"country\":\"ID\",\"language\":\"in\"},\"image\":\"6a8aa913-7579-4276-a159-9ac3f2ff5c84.png\",\"user\":{\"backDropDetection\":true,\"language\":\"in\"},\"name\":\"Soil - Available Phosphorous\",\"uuid\":\"7cb666ea-7913-4511-9ae4-18f78e67aa09\",\"testDate\":\"2017-02-14 14:16\",\"type\":\"caddisfly\",\"app\":{\"appVersion\":\"Version 1.0.0 Alpha 8.6 (Build 167)\",\"language\":\"en\"},\"result\":[{\"name\":\"Available Phosphorous\",\"unit\":\"kg/ha\",\"id\":1,\"value\":\"200.9\"}]}")


(s/def ::wkt-string
  (s/with-gen
    csv/wkt-shape?
    #(s/gen #{polygon multipolygon})))

(s/def ::id (s/with-gen
                     keyword?
                     #(s/gen #{:c1 :c2 :c3})))

(s/def ::title (s/with-gen
                        string?
                        #(s/gen #{"Column 1" "Column 2" "Column 3"})))

(s/def ::key boolean?)

;; alias and custom generator doesn't work so far
;; https://dev.clojure.org/jira/browse/CLJ-2079
(s/def ::multiple-id (s/with-gen
                       lumen.s/str-uuid?
                       #(s/gen (reduce (fn [c _] (conj c (str (squuid)))) #{} (range 100)))))

(s/def ::multiple-type #{:caddisfly})
